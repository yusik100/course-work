# Library Management System

## Курсова робота з дисципліни "Бази даних"

Backend-додаток для автоматизації роботи бібліотеки. Система реалізує повний цикл управління бібліотечним фондом: облік фізичних копій книг, реєстрацію читачів, транзакційний механізм видачі літератури та генерацію аналітичних звітів.

Проєкт демонструє використання реляційної бази даних PostgreSQL у поєднанні з ORM SQLAlchemy та контейнеризацією Docker.

## Виконала: Костанді Юлія ІМ-41

---

## Технологічний стек

* **Мова:** Python 3.10+
* **База даних:** PostgreSQL 15
* **ORM:** SQLAlchemy
* **Міграції:** Alembic
* **Контейнеризація:** Docker & Docker Compose
* **Тестування:** Pytest

---

## Інструкція з запуску


### Крок 1. Клонування репозиторію

```bash
git clone https://github.com/yusik100/course-work.git
cd library_project

```

### Крок 2. Налаштування змінних середовища

Створіть файл конфігурації `.env` на основі прикладу:

```bash
cp .env.example .env

```

### Крок 3. Запуск контейнерів

Підніміть інфраструктуру (додаток + база даних):

```bash
docker-compose up -d --build

```

### Крок 4. Ініціалізація бази даних

Виконайте наступні команди **всередині контейнера** для створення структури таблиць та наповнення тестовими даними:

1. **Застосування міграцій (створення таблиць):**
```bash
docker exec -it library_app_container alembic upgrade head

```

2. **Генерація тестових даних (Seed):**
Скрипт автоматично створить ~30 читачів, 20 книг, 60 копій та історію видач.
```bash
docker exec -it library_app_container python seed.py

```


### Крок 5. Демонстрація роботи системи

Запустіть головний сценарій, який виведе аналітичні звіти та продемонструє процес видачі/повернення книги в реальному часі:

```bash
docker exec -it library_app_container python demo.py

```

---

## Тестування

Проєкт покритий автоматичними тестами, які перевіряють бізнес-логіку, коректність SQL-запитів та роботу транзакцій.

**Запуск усіх тестів:**

```bash
docker exec -it library_app_container pytest

```

**Запуск окремого файлу з тестами:**

```bash
docker exec -it library_app_container pytest tests/unit/test_models.py

```

**Запуск тесту за назвою:**

```bash
docker exec -it library_app_container pytest -v -k "lifecycle"

```

---

## Аналітичні запити

У `docs/queries.md` детально описані та пояснені SQL-запити. Система використовує оптимізовані SQL-запити через ORM:

* **Рейтинг читачів:** Використання віконної функції `RANK()` для побудови справедливого рейтингу активності (врахування однакових місць).
* **Звіт про боржників:** Фільтрація за датою (`due_date < CURRENT_DATE`) та обчислення прострочення.
* **Популярність жанрів:** Використання `JOIN` чотирьох таблиць та агрегації `COUNT/GROUP BY`.


## Структура проєкту

```bash
.
├── src/
│   ├── database.py      # Підключення до БД (Session)
│   ├── models.py        # SQLAlchemy моделі таблиць
│   ├── services.py      # Бізнес-логіка (CRUD операції)
│   └── queries.py       # Аналітичні запити (Звіти)
├── alembic/             # Міграції бази даних
├── docs/                # Додаткова документація
├── tests/               # Unit та Integration тести
├── docker-compose.yml   # Конфігурація Docker
├── Dockerfile           # Інструкція збірки образу
├── demo.py              # Сценарій демонстрації для захисту
├── seed.py              # Генератор тестових даних
└── README.md            # Документація

```